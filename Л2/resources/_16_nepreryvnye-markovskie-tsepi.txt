 НЕПРЕРЫВНЫЕ МАРКОВСКИЕ ЦЕПИ 
 
  Введение 
  Непрерывные марковские цепи в научной литературе описываются системами линейных дифференциальных уравнений Колмогорова, которые являются однородными. В работе [1] получены линейные и нелинейные дифференциальные уравнения вероятностных распределений. Статья посвящена установлению эргодических свойств непрерывных марковских цепей, описываемых неоднородными системами линейных дифференциальных уравнений. 
 
1. Постановка задачи 
Рассмотрим систему линейных дифференциальных уравнений вида dx
= Q t x( ) ,                                                              (1) dt
где Q(t)при каждом t ? 0 является колмогоровской матрицей, т.е. 
n
qij ( )t ? 0,i ? j,    и    ? qij ( )t = 0, j = 1,...,n .                      (2) 
i=1
Будем предполагать, что функции q t i jij ( ), , =1,...,n , являются вещественными, непрерывными и заданными при t ? 0.  
Матрица М={mij} называется марковской, если  
               n mij ? 0, ?mij =1,	i =1,?,n . 
j=1
  Обозначим через Y(t t, 0) фундаментальную матрицу решений системы (1), нормированную в точке t0 . Известно [2], что для того чтобы фундаментальная матрица решений 
Y(t t, 0) системы (1) была марковской при t ? t0 ? 0 , необходимо и достаточно, чтобы матрица Q(t) была колмогоровской при любом t ? 0.  
  Для системы (1) решение x t( ) = x t t( , 0,x0) с начальным условием x0 в момент t0 запишем в виде x t( ) = Y t t( , 0 )x0 .                                                            (3) 
Из этой формулы следует, что при выполнении условий (2) каждому начальному распределению x0  в момент t0отвечает единственное x t( ) = x t t( , 0,x0) распределение, являющееся решением системы (1). При этом матрица 
P t( 0 , )t = Y *(t t, 0 ) 
(* – знак транспонирования матрицы) является матрицей условных вероятностей или переходной матрицей для непрерывной марковской цепи, описываемой системой дифференциальных уравнений (1). 
  Считая начальное  условие x0 распределением вероятностей, преобразуем правую часть системы (1) следующим образом dx
= (Q(t) ? b(t)e + b(t)e)x = (Q(t) ? b(t)e)x + b(t), dt
где b t( ) – произвольный вектор-столбец с компонентами b t b t1( ), 2( ),...,b tn ( ) , которые яв-
ляются вещественными, непрерывными и заданными при 	t ? 0 функциями, e = (1,1,?,1)?вектор-строка, у которой все компоненты единицы. Обозначая через A(t) = Q(t) ?b(t)e, получим систему dx
= A t x( ) + b t( ).                                                       (4) 
dt
n
Легко видеть, что системы (1) и (4) совпадают на интегральном многообразии ?xi =1. 
i=1
Условия (2) для системы (4) примут вид 
A) aij (t) + bi (t) ? 0,i ? j,
	n	                                                                        (5) 
B) ? aij (t) + bi (t) = 0, j = 1,..., n
i=1
  При выполнении условий (5) [1] каждому начальному распределению x0 в момент t0 отвечает распределение x t( ) = x t t( , 0,x0) вероятностей, являющееся решением системы (4). 
Вместо системы (1) удобнее изучать систему (4). 
  Целью статьи является установление эргодических теорем для непрерывных марковских цепей, описываемые системой (1), рассматривая вместо нее систему (4). 
 
2. Неоднородные цепи Маркова 
  Рассмотрим неоднородную марковскую цепь, т.е. когда матрица Q(t)зависит от времени t . Для системы (4) выпишем соответствующую однородную систему  dx
= A t x( ) ,                                                                  (6) 
dt
и обозначим через X(t t, 0) фундаментальную матрицу решений этой системы, нормиро-
	?	n	?
ванную в точке t0 . Введем обозначение K n =?(x ,x ,?,xn )| ?xi =1, xi ? 0,	i =1,?,n?. 
	1	2
	?	i=1	?
Тогда для асимптотической устойчивости решений системы (4) в Kn достаточно, чтобы все элементы фундаментальной матрицы решений системы (6) аннулировались при t ?+?. При этом говорят, что  непрерывная марковская цепь, описываемая системой (1), 
обладает эргодическим свойством.  Из Б) условия (5) следует 
	n	n
? aij (t) =?? bi (t), j = 1,..., n,                                                (7) 
	i=1	i=1
обозначим 
n

b t( ) = ? bi ( )t ,                                                          (8) 
i=1
  Теорема 1. При выполнении условий (5), для любого решения x t( ) = x t t( , 0,x0), системы (6) справедливо равенство 

?n xi (t) = (x01 + x02 +??+ x0 ) exp	?t	??, j = 1,..., n.                      (9) ??? b (?)d?
 =1	n	?	t0	? i
где x01, x02 ,??x0n ? компоненты начального условия x0 
Доказательство. Запишем систему уравнений (6) в скалярной форме 
	dx i (t) = ?n aij (t)x j (t),	i = 1,..., n , 
	dt	j =1
суммируя левую и правую части этих равенств по индексу  i, получим 
	n	n	n
? dx i (t) = ? x j (t)? aij (t). 
	i=1	dx	j=1	i=1
n
Обозначая через p(t) = ? xi (t), и принимая во внимание (8), получим уравнение 
i=1
dp t( )
    =?b t p t( )	( ) dt
с начальным условием p(t0) = x01 + x02 +??+ x0n . Выпишем решение этого уравнения 

p(t) = (x01 + x02 +??+ x0n ) exp ???? ?tt0 b (?)d????, j = 1,..., n. 
      Теорема доказана. 
Введем  обозначения: 
	bi (t) = min qij (t),	i = 1,..., n .  
j?i
Теорема 2. Если выполнены условия (1) и условие 
 ,                                                          (10) 
t0
то непрерывная марковская цепь, описываемая системой (2), обладает эргодическим свойством. 
Доказательство.  Покажем, что система (4) является асимптотически устойчивой в Kn .     
  Из условий aij (t) = qij (t)?bi (t) ? 0, i ? j , следует, что решение x(t) = (x1(t), x2(t),?, xn (t)) системы (6) обладает свойством: x ti ( ) ? 0 при t ?t0, если x ti ( 0) ? 0, i = 1,...,n , и по формуле (9) имеем 
	n	n
       t xi ( )t =xi (t0 ) exp(?? b (? ?)d ) . 
              t i=1	i=1	0
n
Из условия (10) следует, что ? xi (t) ? 0 и xi (t) ? 0,	i =1,?,n, при t ?+? . Т.е. все 
i=1
элементы фундаментальной матрицы X t t( , 0) системы (6) аннулируются при t ?+?, Из асимптотической устойчивости системы (6) следует асимптотическая  устойчивость системы (2) в Kn . Теорема доказана. 
Следствие 1. Пусть элементы q tij ( ) матрицы Q(t) удовлетворяют условиям: qij ( )t >?> 0, i ? j, i j, = 1,...,n, 
то непрерывная неоднородная Марковская цепь, описываемая системой (2), обладает свойством эргодичности. 
Следствие 2. Если матрица Q(t) является ??периодической и выполняется условие 
 , 
то непрерывная периодическая марковская цепь, описываемая системой (2), обладает свойством эргодичности. 
  Следствие 3. Пусть матрица Q является постоянной. Если в матрице Q найдется строка с номером i такая, что qij > 0 при всех j ? i , то непрерывная однородная марковская цепь, описываемая системой (2), обладает свойством эргодичности. 
 
3. Периодические цепи Маркова 
  Рассмотрим отдельно непрерывные марковские цепи, описываемые периодическими линейными дифференциальными уравнениями [2]. При изучении различных задач теории массового обслуживания, учитывающих явную циклическую зависимость от времени (работа телефонной станции с учетом изменений потока требований в течение суток, работа скорой помощи и т.д.), мы приходим к системе (1) с периодическими коэффициентами. 
  Пусть A(t) является непрерывной ?-периодической матричной функцией, b t( ) ??периодической векторной функцией. В работе [2] получен следующий результат: если все мультипликаторы системы (4) по модулю меньше единицы, то в этой системе существует единственное стационарное периодическое распределение вероятностей и все остальные распределения стремятся к нему при t ?+? по экспоненте. Обозначим через ?(t) стационарное периодическое распределение, а через ?0 начальное распределение для ?(t) , тогда будем иметь 
	(	(	))	(	)	( ) ( )	,                            (11) 
t
	( )	( )	( )	(	) (	)	,                             (12) 
или для системы (1): 
?(t ) = Y (t )?0 .                                                        (13) 
Заметим, что у матрицы монодромии Y(?) системы (1) мультипликатор ?=1 является простым и все остальные мультипликаторы по модулю меньше единицы, причем ?0 является стационарным распределением эргодической однородной дискретной цепи Маркова с переходной матрицей Y(?) за один шаг. 
  В качестве примера применения непрерывных периодических марковских цепей рассмотрим работу телефонной линии в периодическом режиме. Интенсивность поступлений вызовов на телефонную линию зависит от времени. Можно считать, что она является периодической функцией (например, суточные колебания интенсивности поступления вызовов на линию). 
  Пусть вероятность поступления на телефонную линию одного вызова за время (t t, + h) равна a t h( ) + o h( ) , следовательно, вероятность не поступления ни одного вызова за то же время (t t, +h) равна 1?a t h( ) +o h( ) . Если в момент t еще продолжается разговор, то за время (t t, +h) он окончится с вероятностью b t h( ) +o h( ) . 
  Пусть x(t), y(t) ?вероятность того, что в момент t линия соответственно свободна и занята. Тогда система дифференциальных уравнений, описывающая работу телефонной линии в периодическом режиме, имеет вид 
?x??=?a t x( ) + b t y( ) ,
	?	                                                 (14) 
?y??= a t x( ) ? b t y( ) ,
где a t b t( ), ( ) ?непрерывные ??периодические функции. При каждом t : a t( ) ? 0, b t( ) ? 0, но a(t) и b t( ) одновременно не равны нулю. 
  Для системы (14) выполняются условия (2), значит система (14) задает непрерывную ??периодическую цепь Маркова с двумя возможными состояниями. Непосредственной проверкой можно убедиться, что матрица 
	?1?? ?( )t	( )t	?
	Y t( ) =?	? ,                                                 (15) 
	? ?( )t	1??( )t ?
является фундаментальной матрицей решений системы (14), где 
	t	t	t	t
	?( )t = ? exp(?? ? (? ?)d	)a s ds( )	,   	( )	exp(	(	)	) ( )	, 
и  , а мультипликаторами являются величины ?1 = 1 , ?2 = 1 ??(?) ??(?) , причем ?2 < 1 . Стало быть, в системе (14) существует един-
ственное периодическое распределение и все остальные распределения стремятся к нему при t ?+?. 
  Начальное распределение (x0, y0), соответствующее стационарному периодическому распределению (x0( )t , y0( )t ), вычисленное по формуле (11), равно 
	??(	)	??(	)
x0 =  ,   y0 =  , ?? ??( ) + ( ) ?? ??( ) + ( )
а стационарное периодическое распределение, вычисленное по формуле (12), будет равно 
	?	t +?	+?
?ds
???x0 ( )t =?? ? ???(	)(1?? ???(	( )))t+ +( () )	( )t	???x
?	??? ?? ?(	)	( )t + (	)(1? ( ))t	 ??	t +?	t +?	. 
???y0 ( )t =	?? ??(	) + (	)	, ?	? exp( ? ? ?d?)a (s)ds
	? y0 (t) = t	s	.
	??	?(?) +?(?)
С ростом времени t вероятность того, что телефонная линия будет занята, стремится к периодической функции y t0( ) .  
 
4. Однородные цепи Маркова 
  Теперь рассмотрим случай непрерывных однородных по времени цепей Маркова, то есть когда матрица A и вектор b являются постоянными, то есть систему вида dx
= Ax + b.                                                            (16) dt
  Теорема 3. Если матрица A и вектор b постоянны и выполнены условия (5), то матрица Q = A+ be всегда имеет собственное число ?= 0, матрица A = Q?be всегда имеет собственное число ?=?(b1 +b2 +...+bn ) , а все остальные собственные числа матриц A и Q совпадают. 
  Доказательство. В определителе Q??E к первой строке прибавим все остальные строки. Полученный определитель разложим по первой строке, тогда получим 
Q ??E  = ??[Q11 (?) + Q12 (?) + ... + Q1n (?)]                     (17) 
где Qij ( )? – алгебраическое дополнение к элементу (qij ???ij ) в матрице (Q ??E ) . Т.е.  матрица Q имеет собственное число ?= 0. С другой стороны, используя свойства определителей, получим 
	 A ?? ? ? ?E = ( ? )[Q11(	) + Q12 (?) ...+ +Q1n (?)]                         (18) 
Значит матрица A имеет собственное число ?=?(b1 +b2 +...+bn ) . Из (17) и (18) следует утверждение теоремы. Теорема доказана 
Теорема 4. Пусть матрица A и вектор b постоянны и выполнены условия (5). Если 

число ?= + + +(b1	b2 ... bn ) является простым собственным числом матрицы A и вещественные части всех остальных собственных чисел матрицы A отрицательны, то в системе (1) существует единственное стационарное распределение, а все остальные распределения в этой системе стремятся к нему при t ?+? . 
Доказательство очевидное. 
	Замечание. Если 	(b1 +b2+...+bn ) > 0 , то элементы фундаментальной матрицы  
X(t t, 0) = exp(A(t ?t0)) аннулируются при t ?+?. Если (b1 +b2+...+bn ) < 0 , то аннулируются компоненты вектора exp(A(t ?t0))(x0 ? y0) при t ?+? при любых начальных условия x0, y0 ?Kn . 
  Обозначим через pстационарное распределение однородной эргодической цепи Маркова, описываемое системой (16), тогда 
p = ? A ?1b = ? (Q ? be) ?1b,                                          (19) 
причем матрица A является обратимой, если (b1 +b2+...+bn ) ? 0. 
  Теперь получим известную формулу для стационарного распределения p в терминах матрицы Q. В формуле (9) положим, например, b = (?, ,..., )0 0 , и пусть {cij } = A?1 = (Q?be)?1, тогда получим 
Q ? be  = ??? , 
где ? = Q11 + Q12 +...+Q1n , и Qij обозначает алгебраическое дополнение к элементу qij в 

матрице Q, далее имеем   
c11 =

Q11	Q12	Q1n
 , c21 =	 ,..., c n1 =	 , 
???	???	???

и 
	? Q	Q	Q	?

p = ??( c11 , c21 , ... , c n 1 ) = ?? ?11 , ?12 , ... , ?1n ?? , 
и окончательно 
	Q11	Q12	=	Q1n	,  (20) 
p1 =	,	,..., p n
      Q11 + Q12 + ... +Q1n Q11 +Q12 + ... +Q1n Q11 +Q12 + ... + Q1n где p1, p2,..., pn – координаты стационарного распределения p. 
 
Заключение 
  Рассматривая вместо однородной системы неоднородную систему линейных дифференциальных уравнений вероятностных распределений, изучены эргодические свойства непрерывных неоднородных, периодических и однородных цепей Маркова. 


