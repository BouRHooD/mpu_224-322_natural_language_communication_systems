
Построение тепловой карты на основе точечных данных об активности пользователя приложения


      овышение сложности компьютерных систем обусловливает рост требова- тельности к пригодности их исполь- зования — «юзабилити» (англ. usability) — степени    эффективности,     трудоемкости и удовлетворенности, с которыми продукт может быть использован определенными пользователями при определенном контек- сте использования для достижения опре- деленных целей [1]. Увеличение степени юзабилити заключается в максимизации указанных характеристик, так как каждая из них играет важную роль как в коммерче- ской сфере, так и в некоммерческой [2]. На- пример, чем меньше времени кассир будет тратить на обработку покупок и чем меньше он будет совершать ошибок при этом, тем больше он сможет обслужить в течение дня покупателей, а значит, больше принесет прибыли магазину [3]. Неразрывно связан- ная с юзабилити тема человеко-компью- терного взаимодействия (human-computer

interaction) включена в современные стан- дарты образования в области информаци- онных технологий [4; 5].
   Методы оценки юзабилити основываются на понимании того, как пользователь ведет себя при взаимодействии с интерфейсом, какие ошибки совершает [6]. Для достиже- ния такого понимания необходимо анализи- ровать данные о его активности (реальном поведении) при работе с программным про- дуктом посредством пользовательского ин- терфейса.
   Существуют различные виды активно- сти пользователя, но наибольший интерес представляют те, которые могут быть визу- ализированы наиболее наглядным и доступ- ным для анализа образом. К ним относятся точечные данные, например клики мышью и движения курсора мыши, которые обыч- но представляются в виде так называемых тепловых карт. Однако в научных источ- никах не удалось обнаружить методы для их построения. Существуют различные про- граммные продукты, в которых реализованы


49




подобные методы, но они являются закры- тыми. В данной статье авторы анализируют способы визуализации активности пользо- вателей программных приложений и пред- лагают формальный метод для построения тепловой карты активности пользователя, а также его реализацию в составе открыто- го программного обеспечения.

активность пользователя и способы ее визуализации
   При анализе взаимодействия пользо- вателя с приложением может быть полез- на любая информация о любой активности пользователя [7]. Чем большим объемом информации владеет эксперт, тем больше факторов он сможет учесть. Однако при этом информация должна быть пригодна для последующей обработки и использова- ния. Например, при тестировании юзабили- ти иногда ведут видеозапись происходяще- го на экране и/или поведения пользователя. Это позволяет отследить практически все виды активности, но последующая обработ- ка таких видеозаписей крайне трудоемка, не говоря уже о сложностях с подготовкой испытуемых. Методика видеозаписи обеспе- чивает полноту собираемой информации, но не обеспечивает способа ее хранения в виде статистических данных, с которыми можно производить дальнейшие операции. Возможность сбора данных активности пользователя вне лабораторных условий также важна. Кэтрин Томпсон (Katherine Thompson) вместе со своими  коллега- ми в 2004 г. опубликовала исследование
«Здесь, там, везде: Удаленное тестирова- ние юзабилити, которое работает» («Here, there, anywhere: Remote usability testing that works») [8], в котором подробно рассказы- вается о разнице между лабораторными ис- следованиями и сбором статистики в реаль- ных условиях. По результатам исследова- ний был сделан вывод, что даже при самой тщательной подготовке испытуемые будут вести себя в лабораторных условиях иначе, чем в реальной жизни, из-за чего некоторые

ошибки могут быть просто не обнаружены при лабораторных исследованиях.
   Существуют различные способы визуа- лизации данных активности пользователя, выбор которых зависит как от их состава и специфики, так и от требований к уровню наглядности и детализации, необходимых для проводимого анализа. Таблицы, напри- мер, являются одним из самых простых и ча- сто используемых способов представления структурированных данных, но они не обе- спечивают достаточной наглядности.
   Наиболее популярны в качестве сред- ства визуализации активности пользовате- ля так называемые тепловые карты, или те- плокарты (англ. heatmap) — графическое представление данных, где хранимые в ви- де матрицы значения отображаются при по- мощи цвета. Подобные системы иерархич- ной кодировки цветов используются в изо- бражениях фракталов и других системах представления данных. Термин «теплокар- та» впервые предложил и официально за- регистрировал как товарный знак разра- ботчик программного обеспечения Кормак Кинни (Cormac Kinney, предприниматель, разработчик) в 1991 г. Он использовал дан- ный термин для описания 2D-изображения, отображающего в режиме реального вре- мени информацию финансового рынка. Интересно, что в 1998 г. право на владение этим товарным знаком было передано ком- пании SS&C TECHNOLOGIES, INC., но она не продлила его, и он перестал действовать в 2006 г. [9].
   Тепловые карты часто связывают с кар- тограммами — способом картографиче- ского изображения, визуально показываю- щим интенсивность какого-либо показателя в пределах территории на карте. Данные мо- гут наноситься на карту штриховкой различ- ной густоты, окраской определенной степе- ни насыщенности (фоновая картограмма) или точками (точечная картограмма).
   Биологические тепловые карты обыч- но используются в молекулярной биоло- гии и медицине для представления дан- ных по экспрессии множества генов в раз-


50




личных образцах, полученных, например, от разных пациентов или в разных услови- ях от одного пациента. Они организованы в виде таблицы, в которой цвет квадрата показывает уровень экспрессии, а столб- цы и строки — различные гены или образ- цы, иерархическая организация которых мо- жет быть изображена в виде дерева на по- лях таблицы.
   Основной принцип, заложенный во всех сферах применения и способах построе- ния тепловых карт, — это представление различных значений при помощи цвета, что обеспечивает высокий уровень наглядности и ускоряет процесс анализа.
   Классические тепловые карты использо- вались в тех областях науки, где исходные данные позволяли достаточно легко опре- делить цвет для конкретной ячейки (уровни экспрессии генов, биржевые индексы), об- ласти (картограммы) или точки/пикселя (то- мограмма мозга в медицинских исследова- ниях, температурная карта в метеорологии). Однако применительно к юзабилити стан- дартные методы построения тепловых карт не обеспечивают должный уровень нагляд- ности для всех типов данных. Некоторые ви- ды активности пользователя, такие как кли- ки мышью и шаг движения курсора, услов- но можно назвать «точечными», потому что они фактически связаны с конкретной точ- кой (пикселем) на экране, что представля- ется слишком малой областью по сравне- нию со всем интерфейсом для детального анализа. К сожалению, в научных источни- ках не удалось обнаружить точных методов для построения тепловых карт на основе точечных данных. Существуют различные программные продукты, реализующие по- добные методы, но они являются закрыты- ми [10].
   В первые годы ХХI в. веб-индустрия на- чала активно применять тепловые карты для отображения данных о кликах, движениях мышью пользователя и переходов по ссыл- кам. В настоящее время трудно определить, кто первым предложил собирать эти данные и использовать их для последующего анали-

за. Существует патент CN 1949259 A «Метод сбора точечной информации путем добавле- ния кода на веб-страницу» («Method for point contacting information of collecting web page by embedding code in web page»), зареги- стрированный в 2006 г. на компанию China Merchants Technology Holdings Co., Ltd [11]. Без привязки к конкретным технологиям он описывает принцип добавления в код веб- страниц логики отслеживания кликов поль- зователя и отправки данных на специальный сервер. Однако в том же 2006 г. появляется израильская интернет-компания ClickTale, которая начинает предлагать схожий веб- сервис для сбора данных о кликах пользо- вателя. В дальнейшем, с повышением инте- реса крупных компаний к подобной анали- тике активности пользователей, появляет- ся множество других аналогичных патентов и различных веб-сервисов. В российском сегменте Интернета популярностью пользу- ется Яндекс.Метрика [12], обладающая ши- роким спектром возможностей для аналити- ки. Данный инструмент позволяет строить различные виды тепловых карт. На рис. 1 приведен пример тепловой карты кликов.
   Зарегистрирован патент «Методы ви- зуализации данных» («Data visualization methods») [13] на метод создания графиче- ского представления данных в виде тепло- вой карты. Он описывает процесс построе- ния тепловой карты без привязки к области юзабилити и анализу активности пользова- теля, основная сфера его применения — представление числовых данных. В нем под- робно изложен принцип представления от- дельных элементов данных в виде окруж- ностей с градиентом интенсивности цвета от центра к краям и принцип суммирования интенсивности при пересечении окружно- стей. На рис. 2 представлен пример рабо- ты метода при использовании равномерного градиента цвета и частичном пересечении окружностей.
   При анализе точечных данных активно- сти пользователя указанный метод плохо применим, поскольку он не учитывает неко- торые важные моменты. Во-первых, не ука-


51




Рис. 1. Тепловая карта кликов, построенная с помощью веб-сервиса Яндекс.Метрика Fig. 1. Click heatmap constructed in Yandex. Metrica web service


зывается, каким образом выбирать началь- ную интенсивность, так как предполагается использование метода для конкретных чис- ловых данных. Во-вторых, при полном пере- крытии одной окружности другой отобра- жается не суммарная интенсивность, а ис- пользуется ее обратное распределение для перекрытой окружности, чтобы она прояви- лась сквозь перекрывающую ее, как пред- ставлено на рис. 3. Это снижает уровень на- глядности при анализе точечных данных ак- тивности пользователя, поскольку наиболь- ший интерес представляет именно общая суммарная интенсивность.

Метод построения тепловой карты

   Учитывая недостатки и закрытость суще- ствующих методов, авторы предлагают но- вый метод построения тепловой карты для точечных данных об активности пользова- теля приложения. Основная идея предлага- емого метода — при построении тепловой карты должны учитываться как плотность расположения данных, так и определяемые экспертом параметры. Эксперт может опре- делять такие параметры, как дистанция гра- диента интенсивности и дистанция перекры- тия. Расшифруем эти понятия.



Рис. 2. Пример построения тепловой карты с равномерным градиентом цвета и частичным пересечением окружностей
Fig. 2. Example of heatmap constructed with a uniform color gradient and partial intersection of the points

52






Рис. 3. Патент на визуализацию точечных данных в виде тепловой карты, перекрытие точек Fig. 3. The patent for the visualization of point data in the heatmap with overlapped points

   Каждый элемент точечной активности представляют в виде окружности с линей- но-убывающим градиентом интенсивности цвета от центра к краям. Радиус окружно- сти (область интенсивности) определяется значением дистанции градиента интенсив- ности (ДГИ) и задается экспертом. Конкрет- ный цвет каждой точки на тепловой карте определяют по значению ее совокупной ин- тенсивности, суммы значений интенсивно- сти всех областей, покрывающих эту точку, и выбранной цветовой схемы (палитры). Ес- ли значение совокупной интенсивности боль- ше 1 (единицы), его необходимо задать рав- ным 1 (единице).
Начальное значение градиента интенсив-
ности И вычисляется по формуле ? ?    1 ,
н	?	???
где МКП — максимальное количество пере- крывающих друг друга окружностей на всей области данных. Две или более окружности считаются перекрывающими друг друга, если расстояние между ними попарно меньше значения дистанции пере- крытия (ДП), заданной экспертом. Конеч- ное значение градиента интенсивности Ик всегда равно 0 (нулю).
   Благодаря расчету Ин на основе МКП обе- спечивается достоверность визуальных дан- ных без потерь. При высокой плотности то- чечных данных наибольшую интенсивность будут иметь отдельные области, фактиче- ски очерченные этими точками, а не те, где сформировалась бы максимальная сово-

купная интенсивность. Например, на рис. 4 изображены две области интенсивности. Для удобства окружности представлены в ви- де треугольников на координатной плоско- сти, где горизонтальная ось — координата (позиция) точки, вертикальная — интенсив- ность.
   Пока расстояние между двумя точками больше половины ДГИ, совокупная интен- сивность меньше 1 (единицы), так как ин- тенсивность рассчитывается по линейному градиенту. Когда же расстояние становит- ся меньше либо равно половине значения ДГИ, совокупная интенсивность становит- ся больше либо равной 1 (единице) соот- ветственно.
   В зависимости от заданного экспертом значения ДП до определенного момента до- пускается потеря визуальных данных, так как в большинстве случаев интерес пред- ставляет именно совокупная интенсивность некоторой области интерфейса. Например, клики по кнопке или ее области, а не по кон- кретной точке на ней. Если точки оказыва- ются на расстоянии меньшем либо равном значению ДП, как, например, на рис. 5, про- исходит перерасчет начальной интенсивно- сти для всех точек.
   На основе значений интенсивности и вы- бранной цветовой схемы (палитры) могут быть построены различные тепловые кар- ты, карты прозрачности и другие разновид- ности карт, выбор конкретной карты зави- сит от специфики проводимого анализа. Под картой прозрачности, например, пони-


53



Дистанция Градиента Интенсивности	Дистанция Перекрытия


1,0


0,5



0,0


Координата	К1	К2

Рис. 4. Пересечение областей интенсивности точек Fig. 4. Intersection of the points’ intensity regions

мается визуализация, при которой области с наименьшей активностью представлены черным непрозрачным цветом, с увеличе- нием прозрачности — в областях с боль- шей интенсивностью. Возможные цветовые схемы и их разновидности в данной статье не рассматриваются.
   Таким образом, под тепловой картой то- чечной активности пользователя будет по- ниматься визуализация точечной активности пользователя, построенная на основе вы- численных значений совокупной интенсив- ности для каждой точки и с использованием определенной цветовой схемы.
   Опишем метод построения тепловой кар- ты точечной активности пользователя, ис- пользуя введенные выше понятия ДГИ, ДП, МКП, начального и конечного значения гра- диента интенсивности.

Метод построения тепловой карты на основе точечных данных
об активности пользователя приложения

   Вход: Точечные данные об активности пользователя (набор точек с указанием их координат на плоскости), значение ДГИ, значение ДП, палитра.
   Выход: Тепловая карта точечной актив- ности пользователя.
   Шаг 1. Получить входные данные. Точеч- ные данные активности пользователя мо- гут генерироваться или собираться любым образом, например, с помощью встраива- ния в программный код специальной логики, которая отслеживает клики мышью на ин- терфейсе и записывает информацию о них в файл. Значение ДГИ, значение ДП и па-


Дистанция Перекрытия


1,0


0,5



0,0


Координата


К1	К2

Рис. 5. Перекрытие областей интенсивности точек Fig. 5. Overlapping of the point’s intensity regions

54




литра определяются экспертом и зависят от специфики проводимого анализа.
Шаг 2. Рассчитать значение МКП.
Шаг 3. Рассчитать значение Ин по фор-

ния рассчитать совокупную интенсивность как сумму значений интенсивности всех об- ластей, покрывающих эту точку.
Шаг 4.2. Если значение совокупной интен-

муле ??

?	1 .
???

сивности больше 1, установить значение со- вокупной интенсивности равным 1 (единице).

   Шаг 4. Для каждого элемента данных ак- тивности пользователя построить на карте область интенсивности в виде окружности с центром в указанной точке, радиус опре- делить равным значению ДГИ и построить линейный градиент значения интенсивно- сти от центра окружности к краям. Началь- ное значение градиента задать равным Ин, конечное — равным 0 (нулю).
   Шаг 4.1. Если области интенсивности двух или более окружностей пересекают- ся, для каждой точки в области пересече-

Шаг 1. Получить входные данные


Шаг 2. Рассчитать значение МКП


Шаг 3. Рассчитать значение Ин

Шаг 4. Построить области интенсивности для каждого элемента данных


Области интенсивности пересекаются?
   
Шаг 5. Визуализировать тепловую карту на основании значений интенсивности для каждой точки и указанной палитры.
Шаг 6. Отдать на выход тепловую карту.
   Графическая схема описанного метода представлена на рис. 6.
   Представленный метод реализован в со- ставе свободного программного обеспечения для сбора и визуализации данных активности пользователей настольных приложений [14]. Пример тепловой карты, построенной в соот- ветствии с методом, представлен на рис. 7.










Да


Нет




Значение совокупной интенсивности > 1?

Нет


Да

Шаг 4.2. Установить значение совокупной интенсивности равным 1






Рис. 6. Схема метода построения тепловой карты Fig. 6. Scheme of the heatmap’s construction method

55




   При построении тепловой карты с исполь- зованием данного продукта можно настра- ивать такие параметры, как прозрачность (карты), палитра, дистанция градиента (обо- значенная в методе как ДГИ) и дистанция пе- рекрытия. Это позволяет добиться требуемо- го уровня подробности визуализации в соот- ветствии с проводимым анализом. Например, иногда выгоднее представлять каждую точеч- ную активность в виде окружности малого ра- диуса, если проводится анализ процесса ра- боты с конкретными кнопками, а иногда важ- нее понимание используемых областей всего интерфейса в целом и значение ДГИ можно указать достаточно большим.

Заключение
   Разработанный метод построения тепло- вой карты на основе точечных данных об ак- тивности пользователя приложения позво- ляет учитывать как плотность расположения данных, так и определяемые экспертом па- раметры — дистанцию градиента интенсив- ности и дистанцию перекрытия. Предложен- ный метод может быть использован при не- посредственном анализе и оценке юзабилити пользовательских интерфейсов, а также при проведении научных исследований в данной сфере. Разработанное программное обеспе- чение, реализующее данный метод, свободно распространяется через Интернет и доступ-

но на сайте Саратовского государственно- го технического университета имени Гагари- на Ю. А. [15]. Полученные результаты будут использованы в последующих научных ис- следованиях при разработке методов оценки юзабилити настольных приложений на осно- ве данных об активности пользователя.








